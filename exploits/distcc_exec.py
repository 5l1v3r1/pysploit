"""
Exploit module for distcc v2.x
"""

from exploits.exploit import Exploit


class distcc_exec(Exploit):
	def __init__(self):

		# Exploit information
		super().__init__()
		self.vuln_name = "distcc_exec"
		self.disclosure_ids = ["CVE-2004-2687"]
		self.vuln_reliability = "HIGH"
		self.vuln_type = "remote code execution"
		self.vuln_description = """
		This module exploits documented a documented vulnerability in distcc
		to execute arbitrary remote commands under the daemon user on any
		system running distcc.
		
		[pysploit docs]
		"""

		# User-set options
		self.options = {
			"victim_ip": None,
			"victim_port": 3632,
			"attacker_ip": None,
			"attacker_port": None,
			"payload": None
		}

	def check_vulnerability(self):
		"""Checks if target is vulnerable to the distcc_exec attack.

		:return: True if target is vulnerable, False if target is not vulnerable
		"""
		pass
